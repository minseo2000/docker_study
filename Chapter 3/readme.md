# 도커 이미지 만들기 
- 이번 장에서는 도커 이미지를 만드는 방법을 배울 것이다.
- Dockerfile 문법과 함께 애플리케이션을 컨테이너화 하는데 필요한 주요 패턴을 익힌다.

## 도커 허브에 공유된 이미지 사용해보기
- web-ping이라는 간단한 애플리케이션을 사용해보자구요!
  - 해당 애플리케이션은 지정된 URL에 HTTP 요청을 3초마다 보내는 동작을 컨테이너가 종료될 때까지 하는 겁니다!


### 도커 허브에서 이미지 내려받기
- docker container run 명령을 사용할 떄 필요한 이미지 중 로컬 컴퓨터에 없는 이미지가 있으면 이미지를 자동으로 내려받아요!
- 소프트웨어 배포 기능이 도커 플랫폼에 완전히 내장됐기 때문에 가능하다고 합니다!
- 도커 CLI를 통해 원하는 이미지를 명시적으로 내려받을 수도 있다고 합니다!
```
docker image pull diamol/ch03-web-ping
```

"ch03-web-ping" 이 이미지는 도커가 이미지를 찾기 위해 가장 먼저 접근하는 도커 허브에 존재한다고 합니다!

- 도커 이미지 = 하나의 파일

- 도커 이미지는 물리적으로는 여러 개의 작은 파일로 구성돼 있는데, 도커가 이들을 조립해 컨테이너의 내부 파일 시스템을 만든다고 합니다.

```
docker contrainer run -d --name web-ping diamol/ch03-web-ping
```

요런 식으로 d 인자를 통해 백그라운드 실행와 name인자를 통해 이름을 지정해 줄 수 있습니다!
```
docker run -d --name web-ping diamol/ch03-web-ping
```

아래와 같이 애플리케이션의 로그를 확인해주고 
```
docker logs web-ping
```

아래와 같이 삭제 해줍시다!

```
docker rm -f web-ping
```

아래와 같이 주소를 지정해 도커를 실행시켜줄 수도 있다!
```
docker run --env TARGET=google.com diamol/ch03-web-ping
```

# 도커 파일 작성하기
-그렇다면 이런 도커 파일 작성을 어떻게 하는 걸까요 ? 

1. "Dockerfile"은 애플리케이션을 패키징하기 위한 간단한 스크립트입니다.
2. "Dockerfile"은 일련의 인스트럭션으로 구성돼 있는데, 인스트럭션(명령)을 실행한 결과로 도커가 만들어집니다!
3. "Dockerfile" 문법은 매우 유연하다! -> 자주 쓰이는 작업은 별도의 명령이 마련돼 있고, 표준 쉘 문법도 사용가능!

## 도커 파일 작성 인스트럭션!

| 인스트럭션   | 사용 예 |
|---------|------|
| FROM    |      |
| ENV     ||
| WORKDIR ||
| COPY    ||
| CMD     ||
|         ||
|         ||
|         ||
|         ||
|         ||
|         ||
|         ||
|         ||
|         ||

## 도커 파일을 만들었다면? 
- 컨테이너 이미지 빌드를 해야합니다!

- 빌드하기
```
docker build --tag web-ping . 
```
- tag인자 : 이미지의 이름

- 빌드된 이미지 목록 불러오기
```
docker ls "w*"
```

- 이미지 실행하기
```
docker run -e TARGET=docker.com -e INTERVAL=5000 web-ping
```

# 이미지와 이미지 레이어에 대해서..
- 앞으로 여러 이미지를 빌드하게 되니까, 이미지의 동작원리를 알아야하고, 컨테이너와 이미지의 관계에 대해 자세히 알아봅시다!

- 이미지를 구성하는 각 레이어가 뭐고? , 이들 레이어가 어떤 명령으로 빌드 됐는지 알 수 있다..

- 도커 이미지의 히스토리 확인하는 방법

```
docker history web-ping
```

# 연습 문제
- 이번 장의 연습문제는 Dockfile 스크립트 없이 도커 이미지를 만드는 것이다!
- Dockerfile의 목적은 애플리케이션의 배포를 자동화하는 것!
